---
metadata:
  name: "Manulife Policy ML03 - Network Security Group Flow Logs must be enabled on all NSGs attached to critical resources"  
  id: "ML03"
  guidelines: "Network Security Group Flow Logs must be enabled on all NSGs attached to critical resources" 
  category: "general"
  severity: "low"
scope:
  provider: "azure" 
definition:
  and:
    
    - cond_type: "filter"
      attribute: "resource_type"
      value:
      - "azurerm_network_security_group"
      operator: "within"
    - cond_type: "connection"
      resource_types:
        - "azurerm_network_watcher_flow_log"
      connected_resource_types:
        - "azurerm_network_security_group"
      operator: "exists"
    - cond_type: "attribute"
      resource_types:
      - "azurerm_network_watcher_flow_log"
      attribute: "network_security_group_id"
      operator: "exists"