---
metadata:
  name: "Manulife Policy ML02 - Resource Lock must be used to prevent accidental deletion of critical resources"  
  id: "ML02"
  guidelines: "Resource Lock must be used to prevent accidental deletion of critical resources" 
  category: "general"
  severity: "low"
scope:
  provider: "azure" 
definition:
  and:
    
    - cond_type: "filter"
      attribute: "resource_type"
      value:
      - "azurerm_resource_group"
      operator: "within"
    - cond_type: "connection"
      resource_types:
        - "azurerm_management_lock"
      connected_resource_types:
        - "azurerm_resource_group"
      operator: "exists"
    - or:
    
      - cond_type: "attribute"
        resource_types:
        - "azurerm_management_lock"
        attribute: "lock_level"
        operator: "equals"
        value: "CanNotDelete"
      - cond_type: "attribute"
        resource_types:
        - "azurerm_management_lock"
        attribute: "lock_level"
        operator: "equals"
        value: "ReadOnly"
